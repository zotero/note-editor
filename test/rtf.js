import { expect } from 'chai';
import { rtfToHtml } from '../src/core/rtf.js';

describe('RTF to HTML converter', () => {
	it('should convert RTF to HTML', () => {
		// Notes.app
		let rtf1 = "{\\rtf1\\ansi\\ansicpg1252\\cocoartf2865\n\\cocoatextscaling0\\cocoaplatform0{\\fonttbl\\f0\\fnil\\fcharset0 AppleSystemUIFont;\\f1\\fswiss\\fcharset0 Helvetica;\\f2\\fnil\\fcharset0 .AppleSystemUIFontMonospaced-Regular;\n\\f3\\fnil\\fcharset0 .AppleSystemUIFontMonospaced-Semibold;}\n{\\colortbl;\\red255\\green255\\blue255;\\red154\\green154\\blue154;}\n{\\*\\expandedcolortbl;;\\csgray\\c66667;}\n{\\*\\listtable{\\list\\listtemplateid1\\listhybrid{\\listlevel\\levelnfc0\\levelnfcn0\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{decimal\\}.}{\\leveltext\\leveltemplateid1\\'02\\'00.;}{\\levelnumbers\\'01;}\\fi-360\\li720\\lin720 }{\\listlevel\\levelnfc0\\levelnfcn0\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{decimal\\}.}{\\leveltext\\leveltemplateid2\\'02\\'01.;}{\\levelnumbers\\'01;}\\fi-360\\li1440\\lin1440 }{\\listname ;}\\listid1}\n{\\list\\listtemplateid2\\listhybrid{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{hyphen\\}}{\\leveltext\\leveltemplateid101\\'01\\uc0\\u8259 ;}{\\levelnumbers;}\\fi-360\\li720\\lin720 }{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{hyphen\\}}{\\leveltext\\leveltemplateid102\\'01\\uc0\\u8259 ;}{\\levelnumbers;}\\fi-360\\li1440\\lin1440 }{\\listname ;}\\listid2}\n{\\list\\listtemplateid3\\listhybrid{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{hyphen\\}}{\\leveltext\\leveltemplateid201\\'01\\uc0\\u8259 ;}{\\levelnumbers;}\\fi-360\\li720\\lin720 }{\\listname ;}\\listid3}\n{\\list\\listtemplateid4\\listhybrid{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{circle\\}}{\\leveltext\\leveltemplateid301\\'01\\uc0\\u9702 ;}{\\levelnumbers;}\\fi-360\\li720\\lin720 }{\\listname ;}\\listid4}\n{\\list\\listtemplateid5\\listhybrid{\\listlevel\\levelnfc0\\levelnfcn0\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{decimal\\}.}{\\leveltext\\leveltemplateid401\\'02\\'00.;}{\\levelnumbers\\'01;}\\fi-360\\li720\\lin720 }{\\listname ;}\\listid5}\n{\\list\\listtemplateid6\\listhybrid{\\listlevel\\levelnfc0\\levelnfcn0\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{decimal\\}.}{\\leveltext\\leveltemplateid501\\'02\\'00.;}{\\levelnumbers\\'01;}\\fi-360\\li720\\lin720 }{\\listname ;}\\listid6}}\n{\\*\\listoverridetable{\\listoverride\\listid1\\listoverridecount0\\ls1}{\\listoverride\\listid2\\listoverridecount0\\ls2}{\\listoverride\\listid3\\listoverridecount0\\ls3}{\\listoverride\\listid4\\listoverridecount0\\ls4}{\\listoverride\\listid5\\listoverridecount0\\ls5}{\\listoverride\\listid6\\listoverridecount0\\ls6}}\n\\deftab560\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\n\\f0\\b\\fs40 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 H1\\\n\\pard\\pardeftab560\\sa40\\pardirnatural\\partightenfactor0\n\n\\fs32 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 H2\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 H3\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\n\\b0 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 \\\n\\\nParagraph\\\n\\\nParagraph line 1\\\nParagraph line 2\\\n\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 One\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl1\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 One one\\\n\\ls1\\ilvl1\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 One two\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 Two\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl1\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 Two one\\\n\\ls1\\ilvl1\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 Two two\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 Three\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\\cf0 \\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls2\\ilvl0\n\\fs24 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 One\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls2\\ilvl1\n\\fs24 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 One one\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls2\\ilvl0\n\\fs24 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 Two\\\n\\ls2\\ilvl0\n\\fs24 \\AppleTypeServices\\AppleTypeServicesF2293774 {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 Three\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls2\\ilvl1\n\\fs24 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 Three one\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\\cf0 \\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls3\\ilvl0\n\\fs24 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cf0 {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 One\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\\cf0 \\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls4\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t\\uc0\\u9702 \t}\\AppleTypeServices\\AppleTypeServicesF2293774 One\\\n\\ls4\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t\\uc0\\u9702 \t}\\AppleTypeServices\\AppleTypeServicesF2293774 Two\\\n\\ls4\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t\\uc0\\u9702 \t}\\AppleTypeServices\\AppleTypeServicesF2293774 Three\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\\cf0 \\\nBlockquote\\\n\\\n\n\\itap1\\trowd \\taflags1 \\trgaph108\\trleft-108 \\trbrdrt\\brdrnil \\trbrdrl\\brdrnil \\trbrdrr\\brdrnil \n\\clvertalt \\clshdrawnil \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt20 \\clpadl100 \\clpadb20 \\clpadr100 \\gaph\\cellx4320\n\\clvertalt \\clshdrawnil \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt20 \\clpadl100 \\clpadb20 \\clpadr100 \\gaph\\cellx8640\n\\pard\\intbl\\itap1\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\\AppleTypeServices \\cf0 a\n\\f1\\fs24 \\cell \n\\pard\\intbl\\itap1\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\n\\f0\\fs26 \\cf0 b\n\\f1\\fs24 \\cell \\row\n\n\\itap1\\trowd \\taflags1 \\trgaph108\\trleft-108 \\trbrdrl\\brdrnil \\trbrdrr\\brdrnil \n\\clvertalt \\clshdrawnil \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt20 \\clpadl100 \\clpadb20 \\clpadr100 \\gaph\\cellx4320\n\\clvertalt \\clshdrawnil \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt20 \\clpadl100 \\clpadb20 \\clpadr100 \\gaph\\cellx8640\n\\pard\\intbl\\itap1\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\n\\f0\\fs26 \\cf0 c\n\\f1\\fs24 \\cell \n\\pard\\intbl\\itap1\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\n\\f0\\fs26 \\cf0 d\n\\f1\\fs24 \\cell \\row\n\n\\itap1\\trowd \\taflags1 \\trgaph108\\trleft-108 \\trbrdrl\\brdrnil \\trbrdrt\\brdrnil \\trbrdrr\\brdrnil \n\\clvertalt \\clshdrawnil \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt20 \\clpadl100 \\clpadb20 \\clpadr100 \\gaph\\cellx4320\n\\clvertalt \\clshdrawnil \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt20 \\clpadl100 \\clpadb20 \\clpadr100 \\gaph\\cellx8640\n\\pard\\intbl\\itap1\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\pardirnatural\\partightenfactor0\n\\cf0 \\cell \n\\pard\\intbl\\itap1\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\pardirnatural\\partightenfactor0\n\\cf0 \n\\f0\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774 \\cell \\lastrow\\row\n\\pard\\pardeftab560\\slleading20\\partightenfactor0\n\n\\f2\\fs24 \\AppleTypeServices \\cf0 function main() \\{\\\n  if (true) \\{\\\n    for (let i = 0; i < 1; i++) \\{\\\n      console.log(\"Hello, world!\");\\\n    \\}\\\n  \\}\\\n\\}\n\\f3\\b \\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls5\\ilvl0\n\\f0\\b0\\fs26 \\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t0.\t}\n\\b \\AppleTypeServices\\AppleTypeServicesF2293774 strong\n\\b0 \\AppleTypeServices\\AppleTypeServicesF2293774 \\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\n\\i \\AppleTypeServices\\AppleTypeServicesF2293774 emphasis\n\\i0 \\AppleTypeServices\\AppleTypeServicesF2293774 \\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 \\ul underline\\ulnone \\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 \\strike \\strikec0 strike\\strike0\\striked0 \\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 O\\AppleTypeServices\\AppleTypeServicesF2293774 \\sub 2\\AppleTypeServices\\AppleTypeServicesF2293774 \\nosupersub \\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 X\\AppleTypeServices\\AppleTypeServicesF2293774 \\super 2\\AppleTypeServices\\AppleTypeServicesF2293774 \\nosupersub \\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 inline code\\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 text color\\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 background color\\\n\\ls5\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t0.\t}{\\field{\\*\\fldinst{HYPERLINK \"https://www.zotero.org/\"}}{\\fldrslt \\AppleTypeServices\\AppleTypeServicesF2293774 \\ul external}}\\AppleTypeServices\\AppleTypeServicesF2293774  link\\\n\\pard\\pardeftab560\\slleading20\\pardirnatural\\partightenfactor0\n\\cf0 \\\n\\\n\\pard\\pardeftab560\\pardirnatural\\partightenfactor0\n\\ls6\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 \\cf0 {\\listtext\t1.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 a\\\n\\ls6\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t2.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 \\\n\\ls6\\ilvl0\\AppleTypeServices\\AppleTypeServicesF2293774\\AppleTypeServicesF393216 {\\listtext\t3.\t}\\AppleTypeServices\\AppleTypeServicesF2293774 c\\\n}";
		let html1 = "<h1>H1</h1><h2>H2</h2><h3>H3</h3><p><br><br>Paragraph<br><br>Paragraph line 1<br>Paragraph line 2</p><ol><li><p>One</p><ol><li><p>One one</p></li><li><p>One two</p></li></ol></li><li><p>Two</p><ol><li><p>Two one</p></li><li><p>Two two</p></li></ol></li><li><p>Three</p></li></ol><p></p><ul><li><p>One</p><ul><li><p>One one</p></li></ul></li><li><p>Two</p></li><li><p>Three</p><ul><li><p>Three one</p></li></ul></li></ul><p></p><ul><li><p>One</p></li></ul><p></p><ul><li><p>One</p></li><li><p>Two</p></li><li><p>Three</p></li></ul><p><br>Blockquote</p><table><tr><td><p>a</p></td><td><p>b</p></td></tr><tr><td><p>c</p></td><td><p>d</p></td></tr><tr><td></td><td></td></tr></table><pre>function main() {\n  if (true) {\n    for (let i = 0; i &lt; 1; i++) {\n      console.log(&quot;Hello, world!&quot;);\n    }\n  }\n}</pre><ol><li><p><strong>strong</strong></p></li><li><p><em>emphasis</em></p></li><li><p><u>underline</u></p></li><li><p><span style=\"text-decoration: line-through\">strike</span></p></li><li><p>O<sub>2</sub></p></li><li><p>X<sup>2</sup></p></li><li><p>inline code</p></li><li><p>text color</p></li><li><p>background color</p></li><li><p><a href=\"https://www.zotero.org/\"><u>external</u></a> link</p></li></ol><p></p><ol><li><p>a</p></li><li><p></p></li><li><p>c</p></li></ol>";

		// Pages.app
		let rtf2 = "{\\rtf1\\ansi\\ansicpg1252\\cocoartf2865\n\\cocoatextscaling0\\cocoaplatform0{\\fonttbl\\f0\\fnil\\fcharset0 HelveticaNeue-Bold;\\f1\\froman\\fcharset0 Times-Roman;\\f2\\froman\\fcharset0 Times-Bold;\n\\f3\\froman\\fcharset0 Times-Italic;\\f4\\fmodern\\fcharset0 Courier;\\f5\\fnil\\fcharset0 HelveticaNeue;\n\\f6\\fswiss\\fcharset0 Helvetica;}\n{\\colortbl;\\red255\\green255\\blue255;\\red0\\green0\\blue0;\\red255\\green255\\blue255;\\red0\\green0\\blue233;\n\\red251\\green0\\blue7;\\red137\\green197\\blue6;\\red242\\green242\\blue242;}\n{\\*\\expandedcolortbl;;\\cssrgb\\c0\\c0\\c0;\\cssrgb\\c100000\\c100000\\c100000;\\cssrgb\\c0\\c0\\c93333;\n\\cssrgb\\c100000\\c0\\c0;\\cssrgb\\c60000\\c80000\\c0;\\cssrgb\\c96078\\c96078\\c96078;}\n{\\*\\listtable{\\list\\listtemplateid1\\listhybrid{\\listlevel\\levelnfc0\\levelnfcn0\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{decimal\\}.}{\\leveltext\\leveltemplateid1\\'02\\'00.;}{\\levelnumbers\\'01;}\\fi-360\\li720\\lin720 }{\\listname ;}\\listid1}\n{\\list\\listtemplateid2\\listhybrid{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{hyphen\\}}{\\leveltext\\leveltemplateid101\\'01\\uc0\\u8259 ;}{\\levelnumbers;}\\fi-360\\li720\\lin720 }{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{hyphen\\}}{\\leveltext\\leveltemplateid102\\'01\\uc0\\u8259 ;}{\\levelnumbers;}\\fi-360\\li1440\\lin1440 }{\\listname ;}\\listid2}}\n{\\*\\listoverridetable{\\listoverride\\listid1\\listoverridecount0\\ls1}{\\listoverride\\listid2\\listoverridecount0\\ls2}}\n\\deftab560\n\\pard\\pardeftab560\\partightenfactor0\n\n\\f0\\b\\fs40 \\cf2 \\cb3 \\up0 \\nosupersub \\ulnone H1\\\n\\pard\\pardeftab560\\sa40\\partightenfactor0\n\n\\fs32 \\cf2 H2\\\n\\pard\\pardeftab560\\partightenfactor0\n\n\\fs26 \\cf2 H3\\\n\\\n\\pard\\tx220\\tx720\\pardeftab720\\li720\\fi-720\\sa240\\partightenfactor0\n\\ls1\\ilvl0\n\\f1\\b0\\fs24 \\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t1.\t}\n\\f2\\b \\cf2 \\cb3 \\up0 \\nosupersub \\ulnone strong\n\\f1\\b0 \\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t2.\t}\n\\f3\\i \\cf2 \\cb3 \\up0 \\nosupersub \\ulnone emphasis\n\\f1\\i0 \\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t3.\t}\\cf2 \\cb3 \\up0 \\nosupersub \\ul \\ulc2 underline\\ulnone \\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t4.\t}\\cf2 \\cb3 \\up0 \\nosupersub \\ulnone \\strike \\strikec2 strike\\strike0\\striked0 \\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t5.\t}\\cf2 \\cb3 \\up0 \\nosupersub \\ulnone O\n\\fs13\\fsmilli6667 \\sub 2\n\\fs24 \\nosupersub \\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t6.\t}\\cf2 \\cb3 \\up0 \\nosupersub \\ulnone X\n\\fs13\\fsmilli6667 \\super 2\n\\fs24 \\nosupersub \\\n\\pard\\tx220\\tx761\\pardeftab720\\li761\\fi-762\\sa240\\partightenfactor0\n\\ls1\\ilvl0\n\\fs26 \\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t7.\t}\n\\f4 \\cf2 \\cb3 \\up0 \\nosupersub \\ulnone inline\n\\f1\\fs24  code\\\n\\pard\\tx220\\tx720\\pardeftab720\\li720\\fi-720\\sa240\\partightenfactor0\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t8.\t}\\cf5 \\cb3 \\up0 \\nosupersub \\ulnone text\\cf2  color\\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t9.\t}\\cf2 \\cb6 \\up0 \\nosupersub \\ulnone background\\cb3  color\\\n\\ls1\\ilvl0\\cf4 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t10.\t}\\cf4 \\cb3 \\up0 \\nosupersub \\ul \\ulc4 internal\\cf2 \\ulnone  and {\\field{\\*\\fldinst{HYPERLINK \"https://www.zotero.org/\"}}{\\fldrslt \\cf4 \\ul \\ulc4 external}} link\\\n\\pard\\tx220\\tx720\\pardeftab720\\li720\\fi-720\\sa240\\partightenfactor0\n\\cf2 \\\n\\pard\\tx20\\tx606\\pardeftab560\\li606\\fi-607\\partightenfactor0\n\\ls2\\ilvl0\n\\f5\\fs31\\fsmilli15600 \\cf2 \\cb1 \\up0 \\nosupersub \\ulnone {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\up0 \\nosupersub \\ulnone 1\\\n\\pard\\tx180\\tx786\\pardeftab560\\li786\\fi-787\\partightenfactor0\n\\ls2\\ilvl1\n\\fs31\\fsmilli15600 \\cf2 \\up0 \\nosupersub \\ulnone {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\up0 \\nosupersub \\ulnone 1.1\\\n\\pard\\tx20\\tx606\\pardeftab560\\li606\\fi-607\\partightenfactor0\n\\ls2\\ilvl0\n\\fs31\\fsmilli15600 \\cf2 \\up0 \\nosupersub \\ulnone {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\up0 \\nosupersub \\ulnone 2\\\n\\ls2\\ilvl0\n\\fs31\\fsmilli15600 \\up0 \\nosupersub \\ulnone {\\listtext\t\\uc0\\u8259 \t}\n\\fs26 \\up0 \\nosupersub \\ulnone 3\\\n\\pard\\pardeftab560\\partightenfactor0\n\\cf2 \\\n\n\\itap1\\trowd \\taflags1 \\trgaph108\\trleft-108 \\trbrdrt\\brdrnil \\trbrdrl\\brdrnil \\trbrdrr\\brdrnil \n\\clvertalt \\clshdrawnil \\clwWidth2940\\clftsWidth3 \\clheight280 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx2880\n\\clvertalt \\clshdrawnil \\clwWidth2940\\clftsWidth3 \\clheight280 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx5760\n\\clvertalt \\clshdrawnil \\clwWidth2940\\clftsWidth3 \\clheight280 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx8640\n\\pard\\intbl\\itap1\\pardeftab720\\partightenfactor0\n\n\\fs20 \\cf2 A\n\\f6\\fs24 \\cf0 \\up0 \\nosupersub \\ulnone \\cell \n\\pard\\intbl\\itap1\\pardeftab720\\partightenfactor0\n\n\\f5\\fs20 \\cf2 \\up0 \\nosupersub \\ulnone B\n\\f6\\fs24 \\cf0 \\up0 \\nosupersub \\ulnone \\cell \n\\pard\\intbl\\itap1\\pardeftab720\\partightenfactor0\n\n\\f5\\fs20 \\cf2 \\up0 \\nosupersub \\ulnone C\n\\f6\\fs24 \\cf0 \\up0 \\nosupersub \\ulnone \\cell \\row\n\n\\itap1\\trowd \\taflags1 \\trgaph108\\trleft-108 \\trbrdrl\\brdrnil \\trbrdrr\\brdrnil \n\\clvertalt \\clcbpat7 \\clwWidth2940\\clftsWidth3 \\clheight260 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx2880\n\\clvertalt \\clcbpat7 \\clwWidth2940\\clftsWidth3 \\clheight260 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx5760\n\\clvertalt \\clcbpat7 \\clwWidth2940\\clftsWidth3 \\clheight260 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx8640\n\\pard\\intbl\\itap1\\pardeftab720\\partightenfactor0\n\n\\f5\\fs20 \\cf2 \\up0 \\nosupersub \\ulnone D\n\\f6\\fs24 \\cf0 \\up0 \\nosupersub \\ulnone \\cell \n\\pard\\intbl\\itap1\\pardeftab720\\partightenfactor0\n\n\\f5\\fs20 \\cf2 \\up0 \\nosupersub \\ulnone E\n\\f6\\fs24 \\cf0 \\up0 \\nosupersub \\ulnone \\cell \n\\pard\\intbl\\itap1\\pardeftab720\\partightenfactor0\n\n\\f5\\fs20 \\cf2 \\up0 \\nosupersub \\ulnone F\n\\f6\\fs24 \\cf0 \\up0 \\nosupersub \\ulnone \\cell \\row\n\n\\itap1\\trowd \\taflags1 \\trgaph108\\trleft-108 \\trbrdrl\\brdrnil \\trbrdrt\\brdrnil \\trbrdrr\\brdrnil \n\\clvertalt \\clshdrawnil \\clwWidth2940\\clftsWidth3 \\clheight280 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx2880\n\\clvertalt \\clshdrawnil \\clwWidth2940\\clftsWidth3 \\clheight280 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx5760\n\\clvertalt \\clshdrawnil \\clwWidth2940\\clftsWidth3 \\clheight280 \\clbrdrt\\brdrs\\brdrw20\\brdrcf2 \\clbrdrl\\brdrs\\brdrw20\\brdrcf2 \\clbrdrb\\brdrs\\brdrw20\\brdrcf2 \\clbrdrr\\brdrs\\brdrw20\\brdrcf2 \\clpadt80 \\clpadl80 \\clpadb80 \\clpadr80 \\gaph\\cellx8640\n\\pard\\intbl\\itap1\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\pardirnatural\\partightenfactor0\n\\cf0 \\cell \n\\pard\\intbl\\itap1\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\pardirnatural\\partightenfactor0\n\\cf0 \\cell \n\\pard\\intbl\\itap1\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\pardirnatural\\partightenfactor0\n\\cf0 \n\\cell \\lastrow\\row\n}";
		let html2 = "<h1>H1</h1><h2>H2</h2><h3>H3</h3><ol><li><p><strong>strong</strong></p></li><li><p><em>emphasis</em></p></li><li><p><u style=\"text-decoration-color: #000000;\">underline</u></p></li><li><p><span style=\"text-decoration: line-through\">strike</span></p></li><li><p>O<sub>2</sub></p></li><li><p>X<sup>2</sup></p></li><li><p>inline code</p></li><li><p><span style=\"background-color: #ffffff; color: #fb0007\">text</span> color</p></li><li><p><span style=\"background-color: #89c506; color: #000000\">background</span> color</p></li><li><p><span style=\"background-color: #ffffff; color: #0000e9\"><u style=\"text-decoration-color: #0000e9;\">internal</u></span> and <a href=\"https://www.zotero.org/\"><span style=\"background-color: #ffffff; color: #0000e9\"><u style=\"text-decoration-color: #0000e9;\">external</u></span></a> link</p></li></ol><p></p><ul><li><p>1</p><ul><li><p>1.1</p></li></ul></li><li><p>2</p></li><li><p>3</p></li></ul><p></p><table><tr><td><p>A</p></td><td><p>B</p></td><td><p>C</p></td></tr><tr><td style=\"background-color: #f2f2f2; background-color: #f2f2f2\"><p>D</p></td><td><p>E</p></td><td><p>F</p></td></tr><tr><td></td><td></td><td></td></tr></table>";

		// TextEdit.app
		let rtf3 = "{\\rtf1\\ansi\\ansicpg1252\\cocoartf2865\n\\cocoatextscaling0\\cocoaplatform0{\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica-BoldOblique;\\f1\\fswiss\\fcharset0 Helvetica-Bold;\\f2\\fswiss\\fcharset0 Helvetica;\n}\n{\\colortbl;\\red255\\green255\\blue255;\\red183\\green202\\blue20;\\red251\\green2\\blue255;}\n{\\*\\expandedcolortbl;;\\cssrgb\\c76538\\c81772\\c8867;\\cssrgb\\c100000\\c25279\\c100000;}\n{\\*\\listtable{\\list\\listtemplateid1\\listhybrid{\\listlevel\\levelnfc0\\levelnfcn0\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{decimal\\})}{\\leveltext\\leveltemplateid1\\'02\\'00);}{\\levelnumbers\\'01;}\\fi-360\\li720\\lin720 }{\\listlevel\\levelnfc23\\levelnfcn23\\leveljc0\\leveljcn0\\levelfollow0\\levelstartat1\\levelspace360\\levelindent0{\\*\\levelmarker \\{hyphen\\}}{\\leveltext\\leveltemplateid2\\'01\\uc0\\u8259 ;}{\\levelnumbers;}\\fi-360\\li1440\\lin1440 }{\\listname ;}\\listid1}}\n{\\*\\listoverridetable{\\listoverride\\listid1\\listoverridecount0\\ls1}}\n\\pard\\tx566\\tx1133\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535\\tx5102\\tx5669\\tx6236\\tx6803\\pardirnatural\\partightenfactor0\n\n\\f0\\i\\b\\fs24 \\cf2 \\cb3 \\ul \\ulc2 \\strike \\strikec2 text\n\\f1\\i0 \\cf0 \\ulnone \\strike0\\striked0 \\\n\n\\f2\\b0 \\cb1 \\\n\\pard\\tx220\\tx720\\tx1133\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535\\tx5102\\tx5669\\tx6236\\tx6803\\li720\\fi-720\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl0\\cf0 {\\listtext\t1)\t}One\\\n\\pard\\tx940\\tx1440\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535\\tx5102\\tx5669\\tx6236\\tx6803\\li1440\\fi-1440\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl1\\cf0 {\\listtext\t\\uc0\\u8259 \t}One one\\\n\\pard\\tx220\\tx720\\tx1133\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535\\tx5102\\tx5669\\tx6236\\tx6803\\li720\\fi-720\\pardirnatural\\partightenfactor0\n\\ls1\\ilvl0\\cf0 {\\listtext\t2)\t}Two\\\n{\\listtext\t3)\t}\\\n{\\listtext\t4)\t}\\\n{\\listtext\t5)\t}Five\\\n}";
		let html3 = "<p><span style=\"background-color: #fb02ff; color: #b7ca14\"><u style=\"text-decoration-color: #b7ca14;\"><span style=\"text-decoration: line-through\"><strong><em>text</em></strong></span></u></span></p><ol><li><p><span style=\"background-color: #ffffff\">One</span></p><ul><li><p><span style=\"background-color: #ffffff\">One one</span></p></li></ul></li><li><p><span style=\"background-color: #ffffff\">Two</span></p></li><li><p></p></li><li><p></p></li><li><p><span style=\"background-color: #ffffff\">Five</span></p></li></ol>";

		expect(rtfToHtml(rtf1)).to.equal(html1);
		expect(rtfToHtml(rtf2)).to.equal(html2);
		expect(rtfToHtml(rtf3)).to.equal(html3);
	});
});
